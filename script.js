// Translations object
const translations = {
  en: {
    portfolio: "Sobirjon",
    home: "Home",
    about: "About",
    projects: "Projects",
    contact: "Contact",
    hello: "Hello, I'm",
    "hero-subtitle": "Frontend Developer",
    "hero-description":
      "Crafting beautiful, functional, and user-centered digital experiences with modern technologies and creative design solutions.",
    "view-work": "View My Work",
    "get-in-touch": "Get In Touch",
    "about-title": "About Me",
    "about-subtitle":
      "Passionate frontend developer with expertise in modern web technologies and a keen eye for design",
    "my-story": "My Story",
    "about-description":
      "I'm a passionate frontend developer with over 1 years of experience creating beautiful, functional, and user-centered digital experiences. I specialize in React, Vue.js, and modern CSS frameworks, always staying up-to-date with the latest industry trends and best practices.",
    experience: "Years Experience",
    "projects-completed": "Projects Completed",
    skills: "Technical Skills",
    "projects-title": "Featured Projects",
    "projects-subtitle":
      "Showcasing my latest works and collaborative projects that demonstrate technical expertise and creative problem-solving",
    all: "All Projects",
    "team-projects": "Team Work",
    "personal-projects": "Personal",
    "team-project": "Team Project",
    "personal-project": "Personal Project",
    "ecommerce-platform": "E-Shop",
    "ecommerce-desc":
      "An online store built on Tailwind and React, where you can register and buy equipment online.",

    "task-manager": "Vue Cinema",
    "task-desc":
      "On this site you can watch high-quality movies online, absolutely free, in 3 different languages.",
    "portfolio-site": "Portfolio Website",
    "portfolio-desc":
      "Responsive portfolio website with dark mode support, functionality, and smooth animations",
    "view-demo": "See Web-site",
    "view-code": "Source Code",
    "contact-title": "Let's Work Together",
    "contact-subtitle":
      "Ready to bring your ideas to life? Let's discuss your next project and create something amazing together",
    "contact-info": "Get In Touch",
    "follow-me": "Connect With Me",
    name: "Full Name",
    email: "Email Address",
    subject: "Subject",
    message: "Message",
    "send-message": "Send Message",
    "all-rights-reserved": "All rights reserved.",
  },
  uz: {
    portfolio: "Sobirjon",
    home: "Bosh sahifa",
    about: "Men haqimda",
    projects: "Loyihalar",
    contact: "Aloqa",
    hello: "Salom, men",
    "hero-subtitle": "Frontend Dasturchi",
    "hero-description":
      "Zamonaviy texnologiyalar va ijodiy dizayn yechimlari bilan chiroyli, funksional va foydalanuvchi-markazli raqamiy tajribalar yaratish.",
    "view-work": "Ishlarimni Ko'rish",
    "get-in-touch": "Bog'lanish",
    "about-title": "Men Haqimda",
    "about-subtitle":
      "Zamonaviy veb texnologiyalarda tajribaga ega bo'lgan va dizaynga ko'zi tushadigan ishtiyoqli frontend dasturchi",
    "my-story": "Mening Hikoyam",
    "about-description":
      "Men 1 yildan ortiq tajribaga ega bo'lgan ishtiyoqli frontend dasturchiman. Chiroyli, funksional va foydalanuvchi-markazli raqamiy tajribalar yarataman. React, Vue.js va zamonaviy CSS frameworklarda ixtisoslashganman, har doim eng so'nggi sanoat tendentsiyalari va eng yaxshi amaliyotlar bilan tanishib turaman.",
    experience: "Yillik Tajriba",
    "projects-completed": "Tugallangan Loyihalar",
    skills: "Texnik Ko'nikmalar",
    "projects-title": "Taniqli Loyihalar",
    "projects-subtitle":
      "Texnik tajriba va ijodiy muammolarni hal qilishni namoyish etadigan eng so'nggi ishlarim va hamkorlik loyihalarimni namoyish etish",
    all: "Barcha Loyihalar",
    "team-projects": "Jamoa Ishi",
    "personal-projects": "Shaxsiy",
    "team-project": "Jamoa Loyihasi",
    "personal-project": "Shaxsiy Loyiha",
    "ecommerce-platform": "Elektron D'okon",
    "ecommerce-desc":
      "Tailwind va React-da qurilgan onlayn-do'kon, u erda siz ro'yxatdan o'tishingiz va jihozlarni onlayn xarid qilishingiz mumkin.",
    "task-manager": "Vue Kino",
    "task-desc":
      "Bu saytda siz 3 xil tilda yuqori sifatli filmlarni onlayn, mutlaqo bepul tomosha qilishingiz mumkin.",
    "portfolio-site": "Portfolio Veb-sayti",
    "portfolio-desc":
      "Qorong'i rejimni qo'llab-quvvatlash, funksionallik va silliq animatsiyalarga ega sezgir portfel veb-sayti",
    "view-demo": "Saytni Ko'rish",
    "contact-title": "Keling Birga Ishlaymiz",
    "contact-subtitle":
      "G'oyalaringizni hayotga tatbiq etishga tayyormisiz? Keyingi loyihangizni muhokama qilib, ajoyib narsa yarataylik",
    "contact-info": "Bog'laning",
    "follow-me": "Men Bilan Bog'laning",
    name: "To'liq Ism",
    email: "Email Manzil",
    subject: "Mavzu",
    message: "Xabar",
    "send-message": "Xabar Yuborish",
    "all-rights-reserved": "Barcha huquqlar himoyalangan.",
  },
  ru: {
    portfolio: "Sobirjon",
    home: "Главная",
    about: "Обо мне",
    projects: "Проекты",
    contact: "Контакты",
    hello: "Привет, я",
    "hero-subtitle": "Frontend Разработчик",
    "hero-description":
      "Создание красивых, функциональных и ориентированных на пользователя цифровых решений с использованием современных технологий и творческих дизайнерских решений.",
    "view-work": "Посмотреть Работы",
    "get-in-touch": "Связаться",
    "about-title": "Обо Мне",
    "about-subtitle":
      "Увлеченный frontend разработчик с опытом в современных веб-технологиях и острым чувством дизайна",
    "my-story": "Моя История",
    "about-description":
      "Я увлеченный frontend разработчик с более чем 1-летним опытом создания красивых, функциональных и ориентированных на пользователя цифровых решений. Специализируюсь на React, Vue.js и современных CSS фреймворках, всегда следя за последними тенденциями в индустрии и лучшими практиками.",
    experience: "Лет Опыта",
    "projects-completed": "Завершенных Проектов",
    skills: "Технические Навыки",
    "projects-title": "Избранные Проекты",
    "projects-subtitle":
      "Демонстрация моих последних работ и совместных проектов, которые показывают техническую экспертизу и творческое решение проблем",
    all: "Все Проекты",
    "team-projects": "Командная Работа",
    "personal-projects": "Личные",
    "team-project": "Командный Проект",
    "personal-project": "Личный Проект",
    "ecommerce-platform": "E-Shop",
    "ecommerce-desc":
      "Интернет-магазин, созданный на Tailwind и React, где вы можете зарегистрироваться и купить оборудование онлайн.",
    "task-manager": "Vue Cinema",
    "task-desc":
      "На этом сайте вы можете смотреть высококачественные фильмы онлайн, абсолютно бесплатно, на 3 разных языках.",
    "portfolio-site": "Сайт-Портфолио",
    "portfolio-desc":
      "Адаптивный сайт-портфолио с поддержкой темного режима, функциональностью и плавной анимацией",
    "view-demo": "Живая Демонстрация",
    "view-code": "Исходный Код",
    "contact-title": "Давайте Работать Вместе",
    "contact-subtitle":
      "Готовы воплотить ваши идеи в жизнь? Давайте обсудим ваш следующий проект и создадим что-то удивительное вместе",
    "contact-info": "Связаться",
    "follow-me": "Связаться Со Мной",
    name: "Полное Имя",
    email: "Email Адрес",
    subject: "Тема",
    message: "Сообщение",
    "send-message": "Отправить Сообщение",
    "all-rights-reserved": "Все права защищены.",
  },
}

// Current language
let currentLanguage = "en"

// DOM Elements
const languageSelector = document.getElementById("languageSelector")
const darkModeToggle = document.getElementById("darkModeToggle")
const mobileMenuToggle = document.getElementById("mobileMenuToggle")
const mobileMenu = document.getElementById("mobileMenu")
const projectFilters = document.querySelectorAll(".project-filter")
const projectCards = document.querySelectorAll(".project-card")
const header = document.getElementById("header")

// Initialize
document.addEventListener("DOMContentLoaded", () => {
  // Check for saved theme preference or default to 'light'
  const savedTheme = localStorage.getItem("theme")
  if (savedTheme === "dark" || (!savedTheme && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
    document.documentElement.classList.add("dark")
  }

  // Check for saved language preference
  const savedLanguage = localStorage.getItem("language") || "en"
  currentLanguage = savedLanguage
  languageSelector.value = savedLanguage
  updateLanguage()

  // Initialize project filter
  filterProjects("all")

  // Initialize animations
  initializeAnimations()
})

// Dark mode toggle
darkModeToggle.addEventListener("click", () => {
  document.documentElement.classList.toggle("dark")
  const isDark = document.documentElement.classList.contains("dark")
  localStorage.setItem("theme", isDark ? "dark" : "light")
})

// Mobile menu toggle with animation
mobileMenuToggle.addEventListener("click", () => {
  const isOpen = mobileMenu.classList.contains("menu-open")

  if (isOpen) {
    // Close menu
    mobileMenu.classList.remove("menu-open")
    mobileMenu.style.transform = "translateY(-100%)"
    mobileMenu.style.opacity = "0"
    mobileMenuToggle.classList.remove("active")
  } else {
    // Open menu
    mobileMenu.classList.add("menu-open")
    mobileMenu.style.transform = "translateY(0)"
    mobileMenu.style.opacity = "1"
    mobileMenuToggle.classList.add("active")
  }
})

// Close mobile menu when clicking on links
document.querySelectorAll(".mobile-nav-link").forEach((link) => {
  link.addEventListener("click", () => {
    mobileMenu.classList.remove("menu-open")
    mobileMenu.style.transform = "translateY(-100%)"
    mobileMenu.style.opacity = "0"
    mobileMenuToggle.classList.remove("active")
  })
})

// Language selector
languageSelector.addEventListener("change", function () {
  currentLanguage = this.value
  localStorage.setItem("language", currentLanguage)
  updateLanguage()
})

// Update language function
function updateLanguage() {
  const elements = document.querySelectorAll("[data-translate]")
  elements.forEach((element) => {
    const key = element.getAttribute("data-translate")
    if (translations[currentLanguage] && translations[currentLanguage][key]) {
      element.textContent = translations[currentLanguage][key]
    }
  })
}

// Project filtering with enhanced animations
projectFilters.forEach((filter) => {
  filter.addEventListener("click", function () {
    const filterValue = this.getAttribute("data-filter")

    // Update active filter
    projectFilters.forEach((f) => f.classList.remove("active"))
    this.classList.add("active")

    // Filter projects
    filterProjects(filterValue)
  })
})

function filterProjects(filter) {
  projectCards.forEach((card, index) => {
    if (filter === "all" || card.classList.contains(filter)) {
      card.style.display = "block"
      // Stagger animation
      setTimeout(() => {
        card.style.opacity = "1"
        card.style.transform = "translateY(0) scale(1)"
      }, index * 100)
    } else {
      card.style.opacity = "0"
      card.style.transform = "translateY(20px) scale(0.95)"
      setTimeout(() => {
        card.style.display = "none"
      }, 300)
    }
  })
}

// Enhanced smooth scrolling for navigation links
document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
  anchor.addEventListener("click", function (e) {
    e.preventDefault()
    const target = document.querySelector(this.getAttribute("href"))
    if (target) {
      const offsetTop = target.offsetTop - 100 // Account for fixed header
      window.scrollTo({
        top: offsetTop,
        behavior: "smooth",
      })
    }
  })
})

// Enhanced form submission with better UX
document.querySelector("form").addEventListener("submit", function (e) {
  e.preventDefault()

  // Get form data
  const formInputs = this.querySelectorAll("input, textarea")
  let isValid = true

  // Enhanced validation
  formInputs.forEach((input) => {
    const value = input.value.trim()
    if (!value) {
      isValid = false
      input.classList.add("border-red-500", "bg-red-50", "dark:bg-red-900/20")
      input.classList.remove("border-gray-200", "dark:border-gray-600")
    } else {
      input.classList.remove("border-red-500", "bg-red-50", "dark:bg-red-900/20")
      input.classList.add("border-green-500", "bg-green-50", "dark:bg-green-900/20")

      // Reset to normal after 2 seconds
      setTimeout(() => {
        input.classList.remove("border-green-500", "bg-green-50", "dark:bg-green-900/20")
        input.classList.add("border-gray-200", "dark:border-gray-600")
      }, 2000)
    }
  })

  if (!isValid) {
    const errorMessage =
      currentLanguage === "uz"
        ? "Iltimos, barcha maydonlarni to'ldiring!"
        : currentLanguage === "ru"
          ? "Пожалуйста, заполните все поля!"
          : "Please fill in all fields!"

    showNotification(errorMessage, "error")
    return
  }

  // Enhanced form submission animation
  const submitButton = this.querySelector('button[type="submit"]')
  const originalHTML = submitButton.innerHTML

  submitButton.innerHTML = `
    <div class="flex items-center justify-center space-x-2">
      <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
      <span>${currentLanguage === "uz" ? "Yuborilmoqda..." : currentLanguage === "ru" ? "Отправляется..." : "Sending..."}</span>
    </div>
  `
  submitButton.disabled = true
  submitButton.classList.add("opacity-75")

  setTimeout(() => {
    const successMessage =
      currentLanguage === "uz"
        ? "Xabar muvaffaqiyatli yuborildi! Tez orada javob beraman."
        : currentLanguage === "ru"
          ? "Сообщение успешно отправлено! Скоро отвечу."
          : "Message sent successfully! I'll get back to you soon."

    showNotification(successMessage, "success")
    this.reset()
    submitButton.innerHTML = originalHTML
    submitButton.disabled = false
    submitButton.classList.remove("opacity-75")

    // Reset form styling
    formInputs.forEach((input) => {
      input.classList.remove("border-green-500", "bg-green-50", "dark:bg-green-900/20")
      input.classList.add("border-gray-200", "dark:border-gray-600")
    })
  }, 2000)
})

// Enhanced notification system
function showNotification(message, type) {
  const notification = document.createElement("div")
  notification.className = `fixed top-24 right-4 z-50 p-4 rounded-xl shadow-2xl transform translate-x-full transition-all duration-500 max-w-sm ${
    type === "success"
      ? "bg-green-500 text-white border-l-4 border-green-600"
      : "bg-red-500 text-white border-l-4 border-red-600"
  }`

  notification.innerHTML = `
    <div class="flex items-center space-x-3">
      <i class="fas ${type === "success" ? "fa-check-circle" : "fa-exclamation-circle"} text-xl"></i>
      <div>
        <p class="font-semibold">${type === "success" ? "Success!" : "Error!"}</p>
        <p class="text-sm opacity-90">${message}</p>
      </div>
    </div>
  `

  document.body.appendChild(notification)

  setTimeout(() => {
    notification.classList.remove("translate-x-full")
    notification.classList.add("translate-x-0")
  }, 100)

  setTimeout(() => {
    notification.classList.add("translate-x-full")
    setTimeout(() => {
      if (document.body.contains(notification)) {
        document.body.removeChild(notification)
      }
    }, 500)
  }, 4000)
}

// Initialize animations and styles
function initializeAnimations() {
  const style = document.createElement("style")
  style.textContent = `
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }

    /* Enhanced hamburger menu */
    .hamburger {
      display: flex;
      flex-direction: column;
      width: 20px;
      height: 16px;
      justify-content: space-between;
      cursor: pointer;
    }

    .hamburger span {
      display: block;
      height: 2px;
      width: 100%;
      background-color: currentColor;
      border-radius: 1px;
      transition: all 0.3s ease;
    }

    .hamburger span:nth-child(1) {
      transform-origin: top left;
    }

    .hamburger span:nth-child(3) {
      transform-origin: bottom left;
    }

    #mobileMenuToggle.active .hamburger span:nth-child(1) {
      transform: rotate(45deg) translate(2px, -2px);
    }

    #mobileMenuToggle.active .hamburger span:nth-child(2) {
      opacity: 0;
      transform: translateX(-10px);
    }

    #mobileMenuToggle.active .hamburger span:nth-child(3) {
      transform: rotate(-45deg) translate(2px, 2px);
    }

    /* Project filter styles */
    .project-filter.active {
      background: linear-gradient(135deg, #0ea5e9, #0284c7);
      color: white;
      box-shadow: 0 8px 25px rgba(14, 165, 233, 0.4);
      transform: translateY(-2px);
    }

    .project-filter:hover:not(.active) {
      background-color: rgba(14, 165, 233, 0.1);
      color: #0ea5e9;
      transform: translateY(-1px);
    }

    .dark .project-filter:hover:not(.active) {
      background-color: rgba(14, 165, 233, 0.2);
      color: #38bdf8;
    }

    /* Project card animations */
    .project-card {
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Scroll animations */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .animate-on-scroll.animated {
      opacity: 1;
      transform: translateY(0);
    }

    /* Header scroll effect */
    .header-scrolled {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .dark .header-scrolled {
      background: rgba(17, 24, 39, 0.95);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    /* Enhanced focus states */
    input:focus, textarea:focus, select:focus {
      outline: none;
      ring: 2px;
      ring-color: #0ea5e9;
      border-color: transparent;
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f5f9;
    }

    .dark ::-webkit-scrollbar-track {
      background: #1e293b;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 4px;
    }

    .dark ::-webkit-scrollbar-thumb {
      background: #475569;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }

    .dark ::-webkit-scrollbar-thumb:hover {
      background: #64748b;
    }
  `
  document.head.appendChild(style)
}

// Enhanced intersection observer for scroll animations
const observerOptions = {
  threshold: 0.1,
  rootMargin: "0px 0px -50px 0px",
}

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      entry.target.classList.add("animated")
    }
  })
}, observerOptions)

// Observe sections for animations
document.querySelectorAll("section").forEach((section) => {
  section.classList.add("animate-on-scroll")
  observer.observe(section)
})

// Enhanced navbar scroll effect
let lastScrollTop = 0
let ticking = false

function updateHeader() {
  const scrollTop = window.pageYOffset || document.documentElement.scrollTop

  if (scrollTop > 100) {
    header.classList.add("header-scrolled")
  } else {
    header.classList.remove("header-scrolled")
  }

  if (scrollTop > lastScrollTop && scrollTop > 200) {
    // Scrolling down
    header.style.transform = "translateY(-100%)"
  } else {
    // Scrolling up
    header.style.transform = "translateY(0)"
  }

  lastScrollTop = scrollTop <= 0 ? 0 : scrollTop
  ticking = false
}

window.addEventListener("scroll", () => {
  if (!ticking) {
    requestAnimationFrame(updateHeader)
    ticking = true
  }
})

// Enhanced active nav link highlighting
window.addEventListener("scroll", () => {
  const sections = document.querySelectorAll("section[id]")
  const navLinks = document.querySelectorAll('.nav-link[href^="#"]')

  let current = ""

  sections.forEach((section) => {
    const sectionTop = section.offsetTop - 150
    const sectionHeight = section.clientHeight

    if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
      current = section.getAttribute("id")
    }
  })

  navLinks.forEach((link) => {
    link.classList.remove("text-primary-600", "dark:text-primary-400")
    link.classList.add("text-gray-700", "dark:text-gray-300")

    if (link.getAttribute("href") === `#${current}`) {
      link.classList.remove("text-gray-700", "dark:text-gray-300")
      link.classList.add("text-primary-600", "dark:text-primary-400")
    }
  })
})

// Add loading animation for images
document.querySelectorAll("img").forEach((img) => {
  img.addEventListener("load", function () {
    this.style.opacity = "1"
    this.style.transform = "scale(1)"
  })

  img.style.opacity = "0"
  img.style.transform = "scale(0.95)"
  img.style.transition = "all 0.3s ease"
})

// Enhanced keyboard navigation
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    // Close mobile menu
    if (mobileMenu.classList.contains("menu-open")) {
      mobileMenu.classList.remove("menu-open")
      mobileMenu.style.transform = "translateY(-100%)"
      mobileMenu.style.opacity = "0"
      mobileMenuToggle.classList.remove("active")
    }
  }
})

// Performance optimization: Debounce resize events
let resizeTimeout
window.addEventListener("resize", () => {
  clearTimeout(resizeTimeout)
  resizeTimeout = setTimeout(() => {
    // Close mobile menu on resize to desktop
    if (window.innerWidth >= 1024) {
      mobileMenu.classList.remove("menu-open")
      mobileMenu.style.transform = "translateY(-100%)"
      mobileMenu.style.opacity = "0"
      mobileMenuToggle.classList.remove("active")
    }
  }, 250)
})
